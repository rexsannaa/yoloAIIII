<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CEFRåˆ†ç´šè‹±èªå­¸ç¿’ç¶²ç«™ç”Ÿæˆç³»çµ±</title>
    <style>
        /* main.css - ä¸»è¦æ¨£å¼ */

        /* å…¨åŸŸè®Šæ•¸å®šç¾© */
        :root {
            /* CEFRç´šåˆ¥è‰²å½©ç³»çµ± */
            --level-a1: #4ade80;  /* A1åˆç´š - æ·ºç¶  */
            --level-a2: #22d3ee;  /* A2ä¸­åˆç´š - å¤©è— */
            --level-b1: #3b82f6;  /* B1ä¸­ç´š - æ¨™æº–è— */
            --level-b2: #8b5cf6;  /* B2ä¸­é«˜ç´š - ç´«è‰² */
            --level-c1: #f59e0b;  /* C1é€²éšç´š - æ©™è‰² */
            --level-c2: #ef4444;  /* C2ç†Ÿç·´ç´š - ç´…è‰² */
            
            /* åŸºç¤è‰²å½© */
            --primary-color: #3b82f6;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #06b6d4;
            
            /* èƒŒæ™¯è‰²å½© */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-dark: #1e293b;
            
            /* æ–‡å­—è‰²å½© */
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-light: #94a3b8;
            --text-white: #ffffff;
            
            /* é‚Šæ¡†è‰²å½© */
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;
            --border-dark: #94a3b8;
            
            /* é™°å½±æ•ˆæœ */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            
            /* é–“è·ç³»çµ± */
            --spacing-xs: 0.25rem; /* 4px */
            --spacing-sm: 0.5rem;  /* 8px */
            --spacing-md: 1rem;    /* 16px */
            --spacing-lg: 1.5rem;  /* 24px */
            --spacing-xl: 2rem;    /* 32px */
            --spacing-2xl: 3rem;   /* 48px */
            
            /* å­—é«”ç³»çµ± */
            --font-sans: system-ui, -apple-system, sans-serif;
            --font-mono: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', monospace;
            
            /* å­—é«”å¤§å° */
            --text-xs: 0.75rem;   /* 12px */
            --text-sm: 0.875rem;  /* 14px */
            --text-base: 1rem;    /* 16px */
            --text-lg: 1.125rem;  /* 18px */
            --text-xl: 1.25rem;   /* 20px */
            --text-2xl: 1.5rem;   /* 24px */
            --text-3xl: 1.875rem; /* 30px */
            --text-4xl: 2.25rem;  /* 36px */
            
            /* åœ“è§’ç³»çµ± */
            --radius-sm: 0.25rem;  /* 4px */
            --radius-md: 0.5rem;   /* 8px */
            --radius-lg: 0.75rem;  /* 12px */
            --radius-xl: 1rem;     /* 16px */
            --radius-full: 9999px;
            
            /* å‹•ç•«æ™‚é–“ */
            --duration-fast: 0.15s;
            --duration-normal: 0.3s;
            --duration-slow: 0.5s;
            
            /* å‹•ç•«æ•ˆæœ */
            --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
            --ease-out: cubic-bezier(0, 0, 0.2, 1);
            --ease-in: cubic-bezier(0.4, 0, 1, 1);
        }

        /* åŸºç¤æ¨£å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            line-height: 1.5;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            color: var(--text-primary);
            background-color: var(--bg-secondary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* æ¨™é¡Œæ¨£å¼ */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: var(--spacing-md);
            color: var(--text-primary);
        }

        h1 { font-size: var(--text-4xl); }
        h2 { font-size: var(--text-3xl); }
        h3 { font-size: var(--text-2xl); }
        h4 { font-size: var(--text-xl); }
        h5 { font-size: var(--text-lg); }
        h6 { font-size: var(--text-base); }

        /* æ®µè½å’Œæ–‡å­— */
        p {
            margin-bottom: var(--spacing-md);
            color: var(--text-secondary);
        }

        /* é€£çµæ¨£å¼ */
        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color var(--duration-fast) var(--ease-out);
        }

        a:hover {
            color: var(--primary-color);
            opacity: 0.8;
        }

        /* æŒ‰éˆ•åŸºç¤æ¨£å¼ */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--text-sm);
            font-weight: 500;
            border: none;
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
            text-decoration: none;
            white-space: nowrap;
            user-select: none;
            min-height: 44px; /* è§¸æ§å‹å¥½çš„æœ€å°é«˜åº¦ */
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* æŒ‰éˆ•è®Šé«” */
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--text-white);
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover:not(:disabled) {
            background-color: var(--primary-color);
            opacity: 0.9;
            box-shadow: var(--shadow-md);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            border: 1px solid var(--border-medium);
        }

        .btn-secondary:hover:not(:disabled) {
            background-color: var(--bg-tertiary);
            border-color: var(--border-dark);
        }

        .btn-success {
            background-color: var(--success-color);
            color: var(--text-white);
        }

        .btn-success:hover:not(:disabled) {
            background-color: var(--success-color);
            opacity: 0.9;
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover:not(:disabled) {
            background-color: var(--primary-color);
            color: var(--text-white);
        }

        /* æŒ‰éˆ•å¤§å°è®Šé«” */
        .btn-large {
            padding: var(--spacing-md) var(--spacing-xl);
            font-size: var(--text-base);
            min-height: 52px;
        }

        .btn-small {
            padding: var(--spacing-xs) var(--spacing-md);
            font-size: var(--text-xs);
            min-height: 36px;
        }

        /* CEFRç´šåˆ¥å¾½ç« æ¨£å¼ */
        .level-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-full);
            font-weight: 600;
            font-size: var(--text-xs);
            color: var(--text-white);
            min-width: 40px;
            height: 24px;
        }

        .level-badge.a1 { background-color: var(--level-a1); }
        .level-badge.a2 { background-color: var(--level-a2); }
        .level-badge.b1 { background-color: var(--level-b1); }
        .level-badge.b2 { background-color: var(--level-b2); }
        .level-badge.c1 { background-color: var(--level-c1); }
        .level-badge.c2 { background-color: var(--level-c2); }

        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--bg-tertiary);
            border-radius: var(--radius-full);
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: var(--radius-full);
            transition: width var(--duration-normal) var(--ease-out);
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.3),
                transparent
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* å¡ç‰‡æ¨£å¼ */
        .card {
            background-color: var(--bg-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            padding: var(--spacing-lg);
            transition: all var(--duration-fast) var(--ease-out);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        /* è¼¸å…¥å…ƒç´ æ¨£å¼ */
        input, textarea, select {
            font-family: inherit;
            font-size: var(--text-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            border: 1px solid var(--border-medium);
            border-radius: var(--radius-md);
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: all var(--duration-fast) var(--ease-out);
            min-height: 44px;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* å–®é¸æŒ‰éˆ•æ¨£å¼ */
        input[type="radio"] {
            width: 20px;
            height: 20px;
            min-height: auto;
            margin-right: var(--spacing-sm);
            accent-color: var(--primary-color);
        }

        /* æ¨™ç±¤æ¨£å¼ */
        label {
            font-size: var(--text-sm);
            font-weight: 500;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* =================== å°èˆªåˆ—æ¨£å¼ =================== */
        .main-nav {
            background-color: var(--bg-primary);
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-light);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 64px;
        }

        .nav-brand {
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .nav-brand h1 {
            font-size: var(--text-xl);
            margin: 0;
            color: var(--primary-color);
        }

        .level-indicator {
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: 500;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: var(--spacing-lg);
            margin: 0;
        }

        .nav-link {
            color: var(--text-secondary);
            font-weight: 500;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--radius-md);
            transition: all var(--duration-fast) var(--ease-out);
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--primary-color);
            background-color: rgba(59, 130, 246, 0.1);
        }

        /* =================== æ‡‰ç”¨ç¨‹å¼å®¹å™¨ =================== */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--spacing-2xl) var(--spacing-lg);
        }

        /* æ¨¡çµ„åŸºç¤æ¨£å¼ */
        .module {
            display: none;
            animation: fadeIn var(--duration-normal) var(--ease-out);
        }

        .module.active {
            display: block;
        }

        .module-header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
            padding-bottom: var(--spacing-lg);
            border-bottom: 1px solid var(--border-light);
        }

        .module-header h2 {
            color: var(--primary-color);
            margin-bottom: var(--spacing-sm);
        }

        .module-header p {
            font-size: var(--text-lg);
            color: var(--text-secondary);
            margin: 0;
        }

        /* =================== CEFRåˆ†ç´šæ¸¬é©—æ¨¡çµ„æ¨£å¼ =================== */

        /* ç´šåˆ¥ä»‹ç´¹å¡ç‰‡ */
        .level-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-2xl);
        }

        .level-card {
            background-color: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            text-align: center;
            box-shadow: var(--shadow-sm);
            transition: all var(--duration-fast) var(--ease-out);
            cursor: pointer;
        }

        .level-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .level-card .level-badge {
            font-size: var(--text-lg);
            width: 60px;
            height: 60px;
            margin: 0 auto var(--spacing-md);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .level-card h3 {
            margin-bottom: var(--spacing-sm);
            font-size: var(--text-lg);
        }

        .level-card p {
            font-size: var(--text-sm);
            color: var(--text-secondary);
            margin: 0;
        }

        /* æ¸¬é©—é€²åº¦æ¢ */
        .progress-bar {
            position: relative;
            margin-bottom: var(--spacing-xl);
        }

        .progress-text {
            position: absolute;
            right: 0;
            top: -24px;
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        /* å•é¡Œå®¹å™¨ */
        .question-container {
            background-color: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-2xl);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--shadow-sm);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
        }

        .question-type {
            background-color: var(--info-color);
            color: var(--text-white);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-md);
            font-size: var(--text-xs);
            font-weight: 600;
        }

        .question-level {
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        .question-content h3 {
            font-size: var(--text-xl);
            margin-bottom: var(--spacing-lg);
            line-height: 1.4;
        }

        /* é¸é …å®¹å™¨ */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .option-label {
            display: flex;
            align-items: center;
            padding: var(--spacing-md);
            background-color: var(--bg-secondary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
            border: 2px solid transparent;
        }

        .option-label:hover {
            background-color: var(--bg-tertiary);
            border-color: var(--border-medium);
        }

        .option-label:has(input:checked) {
            background-color: rgba(59, 130, 246, 0.1);
            border-color: var(--primary-color);
        }

        .option-text {
            margin-left: var(--spacing-sm);
            font-size: var(--text-base);
            line-height: 1.4;
        }

        /* æ¸¬é©—æ§åˆ¶æŒ‰éˆ• */
        .test-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--spacing-md);
        }

        /* =================== æ™ºèƒ½å–®è©å¡ç‰‡æ¨¡çµ„æ¨£å¼ =================== */

        .flashcard-module .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-align: left;
        }

        .level-info {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: var(--text-sm);
        }

        .current-level {
            font-weight: 600;
            color: var(--primary-color);
        }

        /* 3Dç¿»è½‰å¡ç‰‡ */
        .flashcard-container {
            max-width: 500px;
            margin: 0 auto;
        }

        .flashcard-3d {
            width: 100%;
            height: 350px;
            position: relative;
            margin-bottom: var(--spacing-xl);
            perspective: 1000px;
        }

        .flashcard-front,
        .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            transition: transform var(--duration-slow) var(--ease-in-out);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: var(--spacing-2xl);
            text-align: center;
        }

        .flashcard-front {
            background: linear-gradient(135deg, var(--primary-color), var(--info-color));
            color: var(--text-white);
        }

        .flashcard-back {
            background: linear-gradient(135deg, var(--success-color), var(--warning-color));
            color: var(--text-white);
            transform: rotateY(180deg);
        }

        .flashcard-3d.flipped .flashcard-front {
            transform: rotateY(-180deg);
        }

        .flashcard-3d.flipped .flashcard-back {
            transform: rotateY(0deg);
        }

        .word-level-badge {
            position: absolute;
            top: var(--spacing-lg);
            right: var(--spacing-lg);
            background-color: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: 600;
        }

        .word-main {
            font-size: var(--text-4xl);
            font-weight: 700;
            margin-bottom: var(--spacing-md);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .word-phonetic {
            font-size: var(--text-lg);
            opacity: 0.9;
            font-family: var(--font-mono);
        }

        .word-meaning {
            font-size: var(--text-2xl);
            font-weight: 600;
            margin-bottom: var(--spacing-lg);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .word-etymology {
            font-size: var(--text-sm);
            opacity: 0.8;
            margin-bottom: var(--spacing-lg);
            font-style: italic;
        }

        .word-example {
            background-color: rgba(255, 255, 255, 0.1);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            backdrop-filter: blur(10px);
        }

        .example-english {
            font-size: var(--text-lg);
            margin-bottom: var(--spacing-sm);
            font-weight: 500;
        }

        .example-chinese {
            font-size: var(--text-base);
            opacity: 0.9;
        }

        /* å¡ç‰‡æ§åˆ¶æŒ‰éˆ• */
        .flashcard-controls {
            display: flex;
            justify-content: center;
            gap: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
        }

        .flashcard-progress {
            text-align: center;
        }

        .progress-info {
            margin-bottom: var(--spacing-sm);
            font-size: var(--text-sm);
            color: var(--text-secondary);
        }

        /* =================== å…¨åŸŸé€²åº¦æŒ‡ç¤ºå™¨ =================== */

        .global-progress {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: var(--bg-primary);
            border-top: 1px solid var(--border-light);
            padding: var(--spacing-lg);
            box-shadow: var(--shadow-lg);
            z-index: 50;
        }

        .progress-steps {
            display: flex;
            justify-content: center;
            gap: var(--spacing-lg);
            max-width: 800px;
            margin: 0 auto;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--spacing-xs);
            cursor: pointer;
            transition: all var(--duration-fast) var(--ease-out);
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: var(--bg-tertiary);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-sm);
            font-weight: 600;
            transition: all var(--duration-fast) var(--ease-out);
        }

        .step.completed .step-number {
            background-color: var(--success-color);
            color: var(--text-white);
        }

        .step.active .step-number {
            background-color: var(--primary-color);
            color: var(--text-white);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .step span {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            transition: color var(--duration-fast) var(--ease-out);
        }

        .step.completed span,
        .step.active span {
            color: var(--text-primary);
            font-weight: 500;
        }

        /* è¼‰å…¥å‹•ç•« */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .loading-spinner {
            text-align: center;
            color: var(--text-white);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid var(--text-white);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto var(--spacing-md);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* é€šç”¨å‹•ç•«é¡åˆ¥ */
        .fade-in {
            animation: fadeIn var(--duration-normal) var(--ease-out);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* é€šçŸ¥è¨Šæ¯ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            padding: var(--spacing-md);
            max-width: 400px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform var(--duration-normal) var(--ease-out);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.hide {
            transform: translateX(400px);
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary-color);
            color: var(--text-white);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: var(--text-xs);
            font-weight: 600;
            flex-shrink: 0;
        }

        .notification-success .notification-icon {
            background: var(--success-color);
        }

        .notification-error .notification-icon {
            background: var(--error-color);
        }

        .notification-warning .notification-icon {
            background: var(--warning-color);
        }

        .notification-message {
            flex: 1;
            font-size: var(--text-sm);
        }

        .notification-close {
            background: none;
            border: none;
            font-size: var(--text-lg);
            cursor: pointer;
            color: var(--text-secondary);
            padding: var(--spacing-xs);
            line-height: 1;
        }

        .notification-close:hover {
            color: var(--text-primary);
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 768px) {
            .nav-container {
                padding: 0 var(--spacing-md);
            }
            
            .nav-brand h1 {
                font-size: var(--text-lg);
            }
            
            .nav-menu {
                gap: var(--spacing-sm);
            }
            
            .nav-link {
                padding: var(--spacing-xs) var(--spacing-sm);
                font-size: var(--text-xs);
            }
            
            .app-container {
                padding: var(--spacing-lg) var(--spacing-md);
            }
            
            .level-overview {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--spacing-md);
            }
            
            .level-card {
                padding: var(--spacing-md);
            }
            
            .level-card .level-badge {
                width: 40px;
                height: 40px;
                font-size: var(--text-sm);
                margin-bottom: var(--spacing-sm);
            }
            
            .question-container {
                padding: var(--spacing-lg);
            }
            
            .flashcard-3d {
                height: 280px;
            }
            
            .word-main {
                font-size: var(--text-3xl);
            }
            
            .word-meaning {
                font-size: var(--text-xl);
            }
            
            .progress-steps {
                gap: var(--spacing-sm);
            }
            
            .step span {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- å°èˆªåˆ— -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <h1>CEFR è‹±èªå­¸ç¿’</h1>
                <span class="level-indicator" id="userLevelBadge">æœªæ¸¬è©¦</span>
            </div>
            <ul class="nav-menu">
                <li><a href="#assessment" class="nav-link active" data-module="assessment">åˆ†ç´šæ¸¬é©—</a></li>
                <li><a href="#flashcard" class="nav-link" data-module="flashcard">å–®è©å¡ç‰‡</a></li>
                <li><a href="#reading" class="nav-link" data-module="reading">é–±è®€ç†è§£</a></li>
                <li><a href="#quiz" class="nav-link" data-module="quiz">ç†è§£æ¸¬è©¦</a></li>
                <li><a href="#poster" class="nav-link" data-module="poster">æˆå°±æµ·å ±</a></li>
            </ul>
        </div>
    </nav>

    <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
    <main class="app-container">
        <!-- 0. CEFRåˆ†ç´šæ¸¬é©—æ¨¡çµ„ -->
        <section id="assessment-module" class="module active">
            <div class="module-header">
                <h2>CEFR è‹±èªæ°´å¹³æ¸¬è©¦</h2>
                <p>é€éæ™ºèƒ½è©•ä¼°ç¢ºå®šæ‚¨çš„è‹±èªæ°´å¹³ç´šåˆ¥</p>
            </div>
            
            <!-- ç´šåˆ¥ä»‹ç´¹ -->
            <div class="level-overview">
                <div class="level-card" data-level="A1">
                    <div class="level-badge a1">A1</div>
                    <h3>åˆç´š</h3>
                    <p>åŸºç¤æ—¥å¸¸è¡¨é” (500-1000è©å½™)</p>
                </div>
                <div class="level-card" data-level="A2">
                    <div class="level-badge a2">A2</div>
                    <h3>ä¸­åˆç´š</h3>
                    <p>ç°¡å–®äº¤æµå°è©± (1000-2000è©å½™)</p>
                </div>
                <div class="level-card" data-level="B1">
                    <div class="level-badge b1">B1</div>
                    <h3>ä¸­ç´š</h3>
                    <p>ç†Ÿæ‚‰ä¸»é¡Œè¡¨é” (2000-3000è©å½™)</p>
                </div>
                <div class="level-card" data-level="B2">
                    <div class="level-badge b2">B2</div>
                    <h3>ä¸­é«˜ç´š</h3>
                    <p>æµåˆ©è©³ç´°è¡¨é” (3000-4000è©å½™)</p>
                </div>
                <div class="level-card" data-level="C1">
                    <div class="level-badge c1">C1</div>
                    <h3>é€²éšç´š</h3>
                    <p>éˆæ´»æœ‰æ•ˆé‹ç”¨ (4000-6000è©å½™)</p>
                </div>
                <div class="level-card" data-level="C2">
                    <div class="level-badge c2">C2</div>
                    <h3>ç†Ÿç·´ç´š</h3>
                    <p>ç²¾ç´°å«ç¾©å€åˆ† (6000+è©å½™)</p>
                </div>
            </div>

            <!-- æ¸¬é©—å€åŸŸ -->
            <div class="assessment-test" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="assessmentProgressFill"></div>
                    <span class="progress-text" id="assessmentProgressText">1 / 15</span>
                </div>
                
                <div class="question-container">
                    <div class="question-header">
                        <span class="question-type" id="questionType">è©å½™æ¸¬è©¦</span>
                        <span class="question-level" id="questionLevel">A1-A2</span>
                    </div>
                    <div class="question-content">
                        <h3 id="questionText">è¼‰å…¥ä¸­...</h3>
                        <div class="options-container" id="optionsContainer">
                            <!-- é¸é …å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <div class="test-controls">
                    <button id="prevQuestion" class="btn btn-secondary" disabled>ä¸Šä¸€é¡Œ</button>
                    <button id="nextQuestion" class="btn btn-primary">ä¸‹ä¸€é¡Œ</button>
                    <button id="finishTest" class="btn btn-success" style="display: none;">å®Œæˆæ¸¬è©¦</button>
                </div>
            </div>

            <!-- æ¸¬é©—çµæœ -->
            <div class="assessment-result" style="display: none;">
                <div class="result-header">
                    <div class="level-result">
                        <div class="final-level-badge" id="finalLevelBadge">B2</div>
                        <div class="level-description">
                            <h3 id="levelTitle">ä¸­é«˜ç´š</h3>
                            <p id="levelDescription">æ‚¨èƒ½æµåˆ©ä¸”è©³ç´°åœ°è¡¨é”æƒ³æ³•</p>
                        </div>
                    </div>
                </div>
                
                <button id="startLearning" class="btn btn-primary btn-large">é–‹å§‹å€‹æ€§åŒ–å­¸ç¿’</button>
            </div>
            
            <div class="assessment-intro">
                <button id="startAssessment" class="btn btn-primary btn-large">é–‹å§‹CEFRæ°´å¹³æ¸¬è©¦</button>
            </div>
        </section>

        <!-- 1. æ™ºèƒ½å–®è©å¡ç‰‡æ¨¡çµ„ -->
        <section id="flashcard-module" class="module">
            <div class="module-header">
                <h2>æ™ºèƒ½å–®è©å¡ç‰‡</h2>
                <div class="level-info">
                    <span>ç•¶å‰ç´šåˆ¥ï¼š</span>
                    <span class="current-level" id="flashcardLevel">B2</span>
                </div>
            </div>
            
            <div class="flashcard-container">
                <div class="flashcard-3d" id="flashcard3D">
                    <div class="flashcard-front">
                        <div class="word-level-badge" id="wordLevelBadge">B2</div>
                        <div class="word-main" id="wordMain">beautiful</div>
                        <div class="word-phonetic" id="wordPhonetic">/ËˆbjuËtÉªfÊŠl/</div>
                    </div>
                    <div class="flashcard-back">
                        <div class="word-meaning" id="wordMeaning">ç¾éº—çš„ï¼Œæ¼‚äº®çš„</div>
                        <div class="word-etymology" id="wordEtymology">ä¾†è‡ªå¤æ³•èª beaute</div>
                        <div class="word-example">
                            <div class="example-english" id="exampleEnglish">She has beautiful eyes.</div>
                            <div class="example-chinese" id="exampleChinese">å¥¹æœ‰ç¾éº—çš„çœ¼ç›ã€‚</div>
                        </div>
                    </div>
                </div>
                
                <div class="flashcard-controls">
                    <button id="prevCard" class="btn btn-secondary">ä¸Šä¸€å¼µ</button>
                    <button id="flipCard" class="btn btn-primary">ç¿»è½‰</button>
                    <button id="nextCard" class="btn btn-secondary">ä¸‹ä¸€å¼µ</button>
                </div>
                
                <div class="flashcard-progress">
                    <div class="progress-info">
                        <span>é€²åº¦ï¼š</span>
                        <span id="cardProgress">1 / 20</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="cardProgressFill"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 2. å¤šæ¨¡å¼é–±è®€æ¨¡çµ„ -->
        <section id="reading-module" class="module">
            <div class="module-header">
                <h2>å¤šæ¨¡å¼é–±è®€</h2>
                <p>æ™ºèƒ½åˆ†ç´šé–±è®€ç†è§£</p>
            </div>
            
            <div class="card">
                <h3>ç¤ºä¾‹é–±è®€å…§å®¹</h3>
                <p>äººå·¥æ™ºæ…§çš„å¿«é€Ÿé€²æ­¥æ”¹è®Šäº†æˆ‘å€‘å·¥ä½œå’Œç”Ÿæ´»çš„æ–¹å¼ã€‚æ©Ÿå™¨å­¸ç¿’æ¼”ç®—æ³•çš„é€²æ­¥ä½¿é›»è…¦èƒ½å¤ åŸ·è¡Œæ›¾ç¶“è¢«èªç‚ºæ˜¯äººé¡å°ˆæœ‰çš„ä»»å‹™ã€‚</p>
                <p>The rapid advancement of artificial intelligence has transformed the way we work and live. Advancement in machine learning algorithms enables computers to perform tasks that were once thought to be exclusively human.</p>
            </div>
        </section>

        <!-- 3. ç†è§£æ¸¬è©¦è©•ä¼°æ¨¡çµ„ -->
        <section id="quiz-module" class="module">
            <div class="module-header">
                <h2>ç†è§£æ¸¬è©¦</h2>
                <p>æª¢é©—æ‚¨çš„ç†è§£èƒ½åŠ›</p>
            </div>
            
            <div class="card">
                <h3>æ¸¬è©¦é¡Œç›®ç¤ºä¾‹</h3>
                <p>æ ¹æ“šå‰›æ‰çš„é–±è®€å…§å®¹ï¼Œäººå·¥æ™ºæ…§çš„é€²æ­¥ä¸»è¦å½±éŸ¿äº†ä»€éº¼ï¼Ÿ</p>
                <div class="options-container">
                    <label class="option-label">
                        <input type="radio" name="quiz-answer" value="A">
                        <span class="option-text">åƒ…å½±éŸ¿å·¥ä½œæ–¹å¼</span>
                    </label>
                    <label class="option-label">
                        <input type="radio" name="quiz-answer" value="B">
                        <span class="option-text">å·¥ä½œå’Œç”Ÿæ´»æ–¹å¼éƒ½å—åˆ°å½±éŸ¿</span>
                    </label>
                </div>
            </div>
        </section>

        <!-- 4. å€‹æ€§åŒ–æˆå°±æµ·å ±æ¨¡çµ„ -->
        <section id="poster-module" class="module">
            <div class="module-header">
                <h2>å­¸ç¿’æˆå°±æµ·å ±</h2>
                <p>å±•ç¤ºæ‚¨çš„å­¸ç¿’æˆæœ</p>
            </div>
            
            <div class="card">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 2rem; border-radius: 1rem; text-align: center;">
                    <h3>è‹±èªå­¸ç¿’æˆå°±è­‰æ›¸</h3>
                    <div style="margin: 2rem 0;">
                        <div style="display: inline-block; width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2rem; font-weight: bold;">B2</div>
                    </div>
                    <h4>CEFR B2 ä¸­é«˜ç´š</h4>
                    <p>æµåˆ©ä¸”è©³ç´°åœ°è¡¨é”æƒ³æ³•</p>
                </div>
            </div>
        </section>
    </main>

    <!-- å…¨åŸŸé€²åº¦æŒ‡ç¤ºå™¨ -->
    <div class="global-progress">
        <div class="progress-steps">
            <div class="step active" data-step="assessment">
                <div class="step-number">1</div>
                <span>åˆ†ç´šæ¸¬é©—</span>
            </div>
            <div class="step" data-step="flashcard">
                <div class="step-number">2</div>
                <span>å–®è©å­¸ç¿’</span>
            </div>
            <div class="step" data-step="reading">
                <div class="step-number">3</div>
                <span>é–±è®€ç†è§£</span>
            </div>
            <div class="step" data-step="quiz">
                <div class="step-number">4</div>
                <span>ç†è§£æ¸¬è©¦</span>
            </div>
            <div class="step" data-step="poster">
                <div class="step-number">5</div>
                <span>æˆå°±æµ·å ±</span>
            </div>
        </div>
    </div>

    <!-- è¼‰å…¥æŒ‡ç¤ºå™¨ -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>æ­£åœ¨è™•ç†å…§å®¹...</p>
        </div>
    </div>

    <script>
        /**
         * CEFRåˆ†ç´šè‹±èªå­¸ç¿’ç¶²ç«™ - å®Œæ•´æ‡‰ç”¨ç¨‹å¼
         * æ•´åˆæ‰€æœ‰æ¨¡çµ„åŠŸèƒ½çš„å®Œæ•´ç‰ˆæœ¬
         */

        class CEFRLearningApp {
            constructor() {
                // æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
                this.currentModule = 'assessment';
                this.userLevel = null;
                this.eventHandlers = new Map();
                
                // CEFRç´šåˆ¥å®šç¾©
                this.cefrLevels = {
                    A1: { name: 'åˆç´š', description: 'åŸºç¤æ—¥å¸¸è¡¨é”', vocabularyRange: [500, 1000], color: '#4ade80' },
                    A2: { name: 'ä¸­åˆç´š', description: 'ç°¡å–®äº¤æµå°è©±', vocabularyRange: [1000, 2000], color: '#22d3ee' },
                    B1: { name: 'ä¸­ç´š', description: 'ç†Ÿæ‚‰ä¸»é¡Œè¡¨é”', vocabularyRange: [2000, 3000], color: '#3b82f6' },
                    B2: { name: 'ä¸­é«˜ç´š', description: 'æµåˆ©è©³ç´°è¡¨é”', vocabularyRange: [3000, 4000], color: '#8b5cf6' },
                    C1: { name: 'é€²éšç´š', description: 'éˆæ´»æœ‰æ•ˆé‹ç”¨', vocabularyRange: [4000, 6000], color: '#f59e0b' },
                    C2: { name: 'ç†Ÿç·´ç´š', description: 'ç²¾ç´°å«ç¾©å€åˆ†', vocabularyRange: [6000, 10000], color: '#ef4444' }
                };
                
                // æ¨¡çµ„å¯¦ä¾‹
                this.modules = {
                    assessment: new AssessmentModule(this),
                    flashcard: new FlashcardModule(this),
                    reading: new ReadingModule(this),
                    quiz: new QuizModule(this),
                    poster: new PosterModule(this)
                };
            }
            
            /**
             * åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼
             */
            init() {
                console.log('ğŸš€ CEFRå­¸ç¿’æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•ä¸­...');
                
                try {
                    // è¨­å®šäº‹ä»¶ç›£è½
                    this.setupEventListeners();
                    
                    // åˆå§‹åŒ–UIç‹€æ…‹
                    this.initializeUI();
                    
                    // è¼‰å…¥ç”¨æˆ¶è³‡æ–™
                    this.loadUserData();
                    
                    // é–‹å§‹ç¬¬ä¸€å€‹æ¨¡çµ„
                    this.showModule('assessment');
                    
                    console.log('âœ… æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å®Œæˆ');
                    
                } catch (error) {
                    console.error('âŒ æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–å¤±æ•—:', error);
                    this.showNotification('æ‡‰ç”¨ç¨‹å¼è¼‰å…¥å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢', 'error');
                }
            }
            
            /**
             * è¨­å®šå…¨åŸŸäº‹ä»¶ç›£è½
             */
            setupEventListeners() {
                // å°èˆªé€£çµäº‹ä»¶
                const navLinks = document.querySelectorAll('.nav-link');
                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const module = link.dataset.module;
                        if (module) {
                            this.switchModule(module);
                        }
                    });
                });
                
                // å…¨åŸŸé€²åº¦æ­¥é©Ÿé»æ“Š
                const progressSteps = document.querySelectorAll('.step');
                progressSteps.forEach(step => {
                    step.addEventListener('click', () => {
                        const stepName = step.dataset.step;
                        if (stepName && this.isModuleAccessible(stepName)) {
                            this.switchModule(stepName);
                        }
                    });
                });
                
                // éµç›¤å¿«æ·éµ
                document.addEventListener('keydown', (e) => {
                    // Ctrl/Cmd + æ•¸å­—éµåˆ‡æ›æ¨¡çµ„
                    if ((e.ctrlKey || e.metaKey) && e.key >= '1' && e.key <= '5') {
                        e.preventDefault();
                        const moduleIndex = parseInt(e.key) - 1;
                        const modules = ['assessment', 'flashcard', 'reading', 'quiz', 'poster'];
                        if (modules[moduleIndex] && this.isModuleAccessible(modules[moduleIndex])) {
                            this.switchModule(modules[moduleIndex]);
                        }
                    }
                });
            }
            
            /**
             * æ¨¡çµ„åˆ‡æ›ç®¡ç†
             */
            switchModule(moduleName) {
                if (!this.isModuleAccessible(moduleName)) {
                    this.showNotification('è«‹å…ˆå®Œæˆå‰é¢çš„æ­¥é©Ÿ', 'warning');
                    return;
                }
                
                // éš±è—æ‰€æœ‰æ¨¡çµ„
                const allModules = document.querySelectorAll('.module');
                allModules.forEach(module => {
                    module.classList.remove('active');
                });
                
                // é¡¯ç¤ºç›®æ¨™æ¨¡çµ„
                const targetModule = document.getElementById(`${moduleName}-module`);
                if (targetModule) {
                    targetModule.classList.add('active');
                    this.currentModule = moduleName;
                    
                    // æ›´æ–°å°èˆªç‹€æ…‹
                    this.updateNavigation(moduleName);
                    
                    // æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
                    this.updateProgressIndicator(moduleName);
                    
                    // é€šçŸ¥æ¨¡çµ„å·²åˆ‡æ›
                    this.emit('moduleChanged', { module: moduleName });
                    
                    // åˆå§‹åŒ–æ¨¡çµ„ï¼ˆå¦‚æœéœ€è¦ï¼‰
                    if (this.modules[moduleName] && typeof this.modules[moduleName].onShow === 'function') {
                        this.modules[moduleName].onShow();
                    }
                    
                    console.log(`ğŸ“„ åˆ‡æ›åˆ°æ¨¡çµ„: ${moduleName}`);
                } else {
                    console.error(`âŒ æ‰¾ä¸åˆ°æ¨¡çµ„: ${moduleName}`);
                }
            }
            
            /**
             * æª¢æŸ¥æ¨¡çµ„æ˜¯å¦å¯è¨ªå•
             */
            isModuleAccessible(moduleName) {
                // ç¬¬ä¸€å€‹æ¨¡çµ„ï¼ˆassessmentï¼‰ç¸½æ˜¯å¯è¨ªå•
                if (moduleName === 'assessment') {
                    return true;
                }
                
                // å¦‚æœç”¨æˆ¶å·²å®Œæˆåˆ†ç´šæ¸¬é©—ï¼Œå…è¨±è¨ªå•å¾ŒçºŒæ¨¡çµ„
                if (this.userLevel) {
                    return true;
                }
                
                // å¦å‰‡åªèƒ½è¨ªå•æ¸¬é©—æ¨¡çµ„
                return false;
            }
            
            /**
             * æ›´æ–°å°èˆªç‹€æ…‹
             */
            updateNavigation(activeModule) {
                const navLinks = document.querySelectorAll('.nav-link');
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.module === activeModule) {
                        link.classList.add('active');
                    }
                });
            }
            
            /**
             * æ›´æ–°é€²åº¦æŒ‡ç¤ºå™¨
             */
            updateProgressIndicator(activeModule) {
                const steps = document.querySelectorAll('.step');
                const moduleOrder = ['assessment', 'flashcard', 'reading', 'quiz', 'poster'];
                const activeIndex = moduleOrder.indexOf(activeModule);
                
                steps.forEach((step, index) => {
                    step.classList.remove('active', 'completed');
                    
                    if (index < activeIndex || (this.userLevel && index < activeIndex + 1)) {
                        step.classList.add('completed');
                    } else if (index === activeIndex) {
                        step.classList.add('active');
                    }
                });
            }
            
            /**
             * è¨­å®šç”¨æˆ¶ç´šåˆ¥
             */
            setUserLevel(level, abilities = {}) {
                if (!this.cefrLevels[level]) {
                    console.error('âŒ ç„¡æ•ˆçš„CEFRç´šåˆ¥:', level);
                    return;
                }
                
                this.userLevel = level;
                
                // æ›´æ–°UIé¡¯ç¤º
                this.updateLevelDisplay(level);
                
                // å„²å­˜ç”¨æˆ¶è³‡æ–™
                this.saveUserData();
                
                // é€šçŸ¥ç´šåˆ¥è®Šæ›´
                this.emit('levelChanged', { level, abilities });
                
                console.log(`ğŸ¯ ç”¨æˆ¶ç´šåˆ¥è¨­å®šç‚º: ${level} (${this.cefrLevels[level].name})`);
            }
            
            /**
             * æ›´æ–°ç´šåˆ¥é¡¯ç¤º
             */
            updateLevelDisplay(level) {
                const levelBadge = document.getElementById('userLevelBadge');
                if (levelBadge) {
                    levelBadge.textContent = level;
                    levelBadge.className = `level-indicator level-badge ${level.toLowerCase()}`;
                }
            }
            
            /**
             * åˆå§‹åŒ–UIç‹€æ…‹
             */
            initializeUI() {
                // éš±è—è¼‰å…¥å‹•ç•«
                this.hideLoading();
                
                // æª¢æŸ¥è¨­å‚™èƒ½åŠ›
                this.checkDeviceCapabilities();
            }
            
            /**
             * æª¢æŸ¥è¨­å‚™èƒ½åŠ›
             */
            checkDeviceCapabilities() {
                // æª¢æŸ¥è§¸æ§æ”¯æ´
                if ('ontouchstart' in window) {
                    document.body.classList.add('touch-device');
                }
                
                // æª¢æŸ¥ç¶²è·¯ç‹€æ…‹
                if ('onLine' in navigator) {
                    document.body.classList.toggle('offline', !navigator.onLine);
                    
                    window.addEventListener('online', () => {
                        document.body.classList.remove('offline');
                        this.showNotification('ç¶²è·¯é€£ç·šå·²æ¢å¾©', 'success');
                    });
                    
                    window.addEventListener('offline', () => {
                        document.body.classList.add('offline');
                        this.showNotification('ç¶²è·¯é€£ç·šä¸­æ–·ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™', 'warning');
                    });
                }
            }
            
            /**
             * è¼‰å…¥ç”¨æˆ¶è³‡æ–™
             */
            loadUserData() {
                try {
                    // å¾è¨˜æ†¶é«”è®Šæ•¸ä¸­è¼‰å…¥ï¼ˆå› ç‚ºä¸èƒ½ä½¿ç”¨localStorageï¼‰
                    if (window.cefrUserData) {
                        const userData = window.cefrUserData;
                        this.userLevel = userData.level;
                        
                        if (this.userLevel) {
                            this.updateLevelDisplay(this.userLevel);
                        }
                        
                        console.log('ğŸ’¾ ç”¨æˆ¶è³‡æ–™è¼‰å…¥æˆåŠŸ');
                    }
                } catch (error) {
                    console.warn('âš ï¸ ç”¨æˆ¶è³‡æ–™è¼‰å…¥å¤±æ•—:', error);
                }
            }
            
            /**
             * å„²å­˜ç”¨æˆ¶è³‡æ–™
             */
            saveUserData() {
                try {
                    const userData = {
                        level: this.userLevel,
                        lastAccess: new Date().toISOString()
                    };
                    
                    // å„²å­˜åˆ°è¨˜æ†¶é«”è®Šæ•¸ï¼ˆå› ç‚ºä¸èƒ½ä½¿ç”¨localStorageï¼‰
                    window.cefrUserData = userData;
                    
                    console.log('ğŸ’¾ ç”¨æˆ¶è³‡æ–™å„²å­˜æˆåŠŸ');
                } catch (error) {
                    console.error('âŒ ç”¨æˆ¶è³‡æ–™å„²å­˜å¤±æ•—:', error);
                }
            }
            
            /**
             * é¡¯ç¤ºè¼‰å…¥å‹•ç•«
             */
            showLoading(message = 'è¼‰å…¥ä¸­...') {
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    const messageElement = loadingOverlay.querySelector('p');
                    if (messageElement) {
                        messageElement.textContent = message;
                    }
                    loadingOverlay.style.display = 'flex';
                }
            }
            
            /**
             * éš±è—è¼‰å…¥å‹•ç•«
             */
            hideLoading() {
                const loadingOverlay = document.getElementById('loadingOverlay');
                if (loadingOverlay) {
                    loadingOverlay.style.display = 'none';
                }
            }
            
            /**
             * é¡¯ç¤ºé€šçŸ¥è¨Šæ¯
             */
            showNotification(message, type = 'info', duration = 3000) {
                const notification = document.createElement('div');
                notification.className = `notification notification-${type}`;
                notification.innerHTML = `
                    <div class="notification-content">
                        <span class="notification-icon">${this.getNotificationIcon(type)}</span>
                        <span class="notification-message">${message}</span>
                        <button class="notification-close">&times;</button>
                    </div>
                `;
                
                // æ·»åŠ åˆ°é é¢
                document.body.appendChild(notification);
                
                // å‹•ç•«é¡¯ç¤º
                setTimeout(() => notification.classList.add('show'), 10);
                
                // è‡ªå‹•éš±è—
                const autoHide = setTimeout(() => {
                    this.hideNotification(notification);
                }, duration);
                
                // é»æ“Šé—œé–‰
                const closeBtn = notification.querySelector('.notification-close');
                closeBtn.addEventListener('click', () => {
                    clearTimeout(autoHide);
                    this.hideNotification(notification);
                });
                
                return notification;
            }
            
            /**
             * éš±è—é€šçŸ¥è¨Šæ¯
             */
            hideNotification(notification) {
                notification.classList.add('hide');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }
            
            /**
             * å–å¾—é€šçŸ¥åœ–ç¤º
             */
            getNotificationIcon(type) {
                const icons = {
                    success: 'âœ“',
                    error: 'âœ—',
                    warning: 'âš ',
                    info: 'â„¹'
                };
                return icons[type] || icons.info;
            }
            
            /**
             * é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
             */
            showError(message, error = null) {
                console.error('âŒ éŒ¯èª¤:', message, error);
                this.showNotification(message, 'error', 5000);
            }
            
            // ==========================================
            // äº‹ä»¶ç³»çµ±
            // ==========================================
            
            /**
             * äº‹ä»¶ç›£è½å™¨è¨»å†Š
             */
            on(event, callback) {
                if (!this.eventHandlers.has(event)) {
                    this.eventHandlers.set(event, []);
                }
                this.eventHandlers.get(event).push(callback);
            }
            
            /**
             * äº‹ä»¶è§¸ç™¼
             */
            emit(event, data = null) {
                const handlers = this.eventHandlers.get(event);
                if (handlers) {
                    handlers.forEach(callback => {
                        try {
                            callback(data);
                        } catch (error) {
                            console.error(`äº‹ä»¶ ${event} è™•ç†å™¨éŒ¯èª¤:`, error);
                        }
                    });
                }
            }
            
            /**
             * ç§»é™¤äº‹ä»¶ç›£è½å™¨
             */
            off(event, callback) {
                const handlers = this.eventHandlers.get(event);
                if (handlers) {
                    const index = handlers.indexOf(callback);
                    if (index > -1) {
                        handlers.splice(index, 1);
                    }
                }
            }
        }

        /**
         * CEFRåˆ†ç´šæ¸¬é©—æ¨¡çµ„
         */
        class AssessmentModule {
            constructor(app) {
                this.app = app;
                this.currentQuestion = 0;
                this.totalQuestions = 10;
                this.responses = [];
                this.abilities = { vocabulary: 0, grammar: 0, comprehension: 0, reasoning: 0 };
                this.isTestActive = false;
                
                // ç°¡åŒ–çš„æ¸¬é©—é¡Œåº«
                this.questionBank = [
                    {
                        type: 'vocabulary',
                        level: 'A1',
                        question: 'é¸æ“‡ "Hello" çš„æ­£ç¢ºä¸­æ–‡æ„æ€ï¼š',
                        options: ['å†è¦‹', 'ä½ å¥½', 'è¬è¬', 'å°ä¸èµ·'],
                        correct: 1,
                        ability: 'vocabulary'
                    },
                    {
                        type: 'grammar',
                        level: 'A1',
                        question: 'é¸æ“‡æ­£ç¢ºçš„å¥å­ï¼š',
                        options: ['I am student.', 'I am a student.', 'I am the student.', 'I student am.'],
                        correct: 1,
                        ability: 'grammar'
                    },
                    {
                        type: 'vocabulary',
                        level: 'A2',
                        question: 'é¸æ“‡ "beautiful" çš„æœ€ä½³ä¸­æ–‡ç¿»è­¯ï¼š',
                        options: ['å›°é›£çš„', 'ç¾éº—çš„', 'é‡è¦çš„', 'å±éšªçš„'],
                        correct: 1,
                        ability: 'vocabulary'
                    },
                    {
                        type: 'grammar',
                        level: 'A2',
                        question: 'é¸æ“‡æ­£ç¢ºçš„éå»å¼ï¼š',
                        options: ['I go yesterday.', 'I went yesterday.', 'I going yesterday.', 'I goed yesterday.'],
                        correct: 1,
                        ability: 'grammar'
                    },
                    {
                        type: 'vocabulary',
                        level: 'B1',
                        question: 'é¸æ“‡èˆ‡ "accomplish" æ„æ€æœ€æ¥è¿‘çš„è©ï¼š',
                        options: ['fail', 'achieve', 'begin', 'forget'],
                        correct: 1,
                        ability: 'vocabulary'
                    },
                    {
                        type: 'comprehension',
                        level: 'B1',
                        question: 'é–±è®€å¾Œå›ç­”ï¼š"Although the weather was terrible, the concert was successful." ä¸»è¦æ„æ€æ˜¯ï¼š',
                        options: ['å¤©æ°£å¾ˆå¥½', 'éŸ³æ¨‚æœƒå¤±æ•—', 'å„˜ç®¡å¤©æ°£ç³Ÿç³•ï¼ŒéŸ³æ¨‚æœƒæˆåŠŸ', 'å¾ˆå°‘äººåƒåŠ '],
                        correct: 2,
                        ability: 'comprehension'
                    },
                    {
                        type: 'vocabulary',
                        level: 'B2',
                        question: 'é¸æ“‡æœ€é©åˆçš„è©èªï¼š"The company decided to ___ their strategy."',
                        options: ['modify', 'destroy', 'ignore', 'copy'],
                        correct: 0,
                        ability: 'vocabulary'
                    },
                    {
                        type: 'reasoning',
                        level: 'B2',
                        question: 'é‚è¼¯æ¨ç†ï¼š"All birds can fly. Penguins are birds. Therefore..."',
                        options: ['ä¼éµæœƒé£›', 'ä¼éµä¸æœƒé£›', 'ä¼éµä¸æ˜¯é³¥', 'é‚è¼¯æœ‰èª¤'],
                        correct: 3,
                        ability: 'reasoning'
                    },
                    {
                        type: 'vocabulary',
                        level: 'C1',
                        question: 'é¸æ“‡æœ€ç²¾ç¢ºçš„è©èªï¼š"His argument was very ___."',
                        options: ['loud', 'cogent', 'popular', 'lengthy'],
                        correct: 1,
                        ability: 'vocabulary'
                    },
                    {
                        type: 'comprehension',
                        level: 'C1',
                        question: 'ç†è§£å­¸è¡“æ–‡æœ¬ä¸­ "paradigm shift" çš„å«ç¾©ï¼š',
                        options: ['å°æ”¹è®Š', 'é‡å¤§è®Šé©', 'å›åˆ°éå»', 'ä¿æŒç¾ç‹€'],
                        correct: 1,
                        ability: 'comprehension'
                    }
                ];
                
                this.init();
            }
            
            init() {
                console.log('ğŸ“ CEFRåˆ†ç´šæ¸¬é©—æ¨¡çµ„åˆå§‹åŒ–');
                this.setupEventListeners();
            }
            
            setupEventListeners() {
                const startBtn = document.getElementById('startAssessment');
                if (startBtn) {
                    startBtn.addEventListener('click', () => this.startAssessment());
                }
                
                const prevBtn = document.getElementById('prevQuestion');
                const nextBtn = document.getElementById('nextQuestion');
                const finishBtn = document.getElementById('finishTest');
                
                if (prevBtn) prevBtn.addEventListener('click', () => this.previousQuestion());
                if (nextBtn) nextBtn.addEventListener('click', () => this.nextQuestion());
                if (finishBtn) finishBtn.addEventListener('click', () => this.finishAssessment());
                
                const startLearningBtn = document.getElementById('startLearning');
                if (startLearningBtn) {
                    startLearningBtn.addEventListener('click', () => this.startLearningJourney());
                }
            }
            
            startAssessment() {
                console.log('ğŸ¯ é–‹å§‹CEFRåˆ†ç´šæ¸¬é©—');
                
                // éš±è—ä»‹ç´¹ï¼Œé¡¯ç¤ºæ¸¬é©—
                document.querySelector('.assessment-intro').style.display = 'none';
                document.querySelector('.level-overview').style.display = 'none';
                document.querySelector('.assessment-test').style.display = 'block';
                
                // é‡ç½®æ¸¬é©—ç‹€æ…‹
                this.currentQuestion = 0;
                this.responses = [];
                this.isTestActive = true;
                
                // é¡¯ç¤ºç¬¬ä¸€é¡Œ
                this.showQuestion(0);
                this.updateProgress();
            }
            
            showQuestion(questionIndex) {
                if (questionIndex < 0 || questionIndex >= this.questionBank.length) {
                    return;
                }
                
                const question = this.questionBank[questionIndex];
                
                // æ›´æ–°é¡Œç›®å…§å®¹
                const questionText = document.getElementById('questionText');
                const optionsContainer = document.getElementById('optionsContainer');
                const questionType = document.getElementById('questionType');
                const questionLevel = document.getElementById('questionLevel');
                
                if (questionText) {
                    questionText.textContent = question.question;
                }
                
                if (questionType) {
                    const typeNames = {
                        'vocabulary': 'è©å½™æ¸¬è©¦',
                        'grammar': 'èªæ³•æ¸¬è©¦',
                        'comprehension': 'ç†è§£æ¸¬è©¦',
                        'reasoning': 'é‚è¼¯æ¨ç†'
                    };
                    questionType.textContent = typeNames[question.type] || question.type;
                }
                
                if (questionLevel) {
                    questionLevel.textContent = question.level;
                }
                
                // ç”Ÿæˆé¸é …
                if (optionsContainer) {
                    optionsContainer.innerHTML = '';
                    question.options.forEach((option, index) => {
                        const optionLabel = document.createElement('label');
                        optionLabel.className = 'option-label';
                        optionLabel.innerHTML = `
                            <input type="radio" name="question-answer" value="${index}">
                            <span class="option-text">${option}</span>
                        `;
                        optionsContainer.appendChild(optionLabel);
                    });
                    
                    // å¦‚æœå·²ç¶“å›ç­”éï¼Œæ¢å¾©é¸æ“‡
                    const previousAnswer = this.responses[questionIndex];
                    if (previousAnswer !== undefined) {
                        const radioButton = optionsContainer.querySelector(`input[value="${previousAnswer}"]`);
                        if (radioButton) {
                            radioButton.checked = true;
                        }
                    }
                }
                
                // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
                this.updateNavigationButtons();
                this.updateProgress();
            }
            
            previousQuestion() {
                if (this.currentQuestion > 0) {
                    this.saveCurrentAnswer();
                    this.currentQuestion--;
                    this.showQuestion(this.currentQuestion);
                }
            }
            
            nextQuestion() {
                this.saveCurrentAnswer();
                
                if (this.currentQuestion < this.questionBank.length - 1) {
                    this.currentQuestion++;
                    this.showQuestion(this.currentQuestion);
                }
            }
            
            saveCurrentAnswer() {
                const selectedOption = document.querySelector('input[name="question-answer"]:checked');
                if (selectedOption) {
                    this.responses[this.currentQuestion] = parseInt(selectedOption.value);
                }
            }
            
            updateNavigationButtons() {
                const prevBtn = document.getElementById('prevQuestion');
                const nextBtn = document.getElementById('nextQuestion');
                const finishBtn = document.getElementById('finishTest');
                
                if (prevBtn) {
                    prevBtn.disabled = this.currentQuestion === 0;
                }
                
                const isLastQuestion = this.currentQuestion === this.questionBank.length - 1;
                
                if (nextBtn && finishBtn) {
                    if (isLastQuestion) {
                        nextBtn.style.display = 'none';
                        finishBtn.style.display = 'inline-flex';
                    } else {
                        nextBtn.style.display = 'inline-flex';
                        finishBtn.style.display = 'none';
                    }
                }
            }
            
            updateProgress() {
                const progressFill = document.getElementById('assessmentProgressFill');
                const progressText = document.getElementById('assessmentProgressText');
                
                const progress = ((this.currentQuestion + 1) / this.questionBank.length) * 100;
                
                if (progressFill) {
                    progressFill.style.width = `${progress}%`;
                }
                
                if (progressText) {
                    progressText.textContent = `${this.currentQuestion + 1} / ${this.questionBank.length}`;
                }
            }
            
            finishAssessment() {
                this.saveCurrentAnswer();
                
                // è¨ˆç®—çµæœ
                this.calculateResults();
                
                // é¡¯ç¤ºçµæœ
                this.showResults();
                
                console.log('âœ… CEFRåˆ†ç´šæ¸¬é©—å®Œæˆ');
            }
            
            calculateResults() {
                let totalScore = 0;
                let abilityScores = {
                    vocabulary: { correct: 0, total: 0 },
                    grammar: { correct: 0, total: 0 },
                    comprehension: { correct: 0, total: 0 },
                    reasoning: { correct: 0, total: 0 }
                };
                
                // è¨ˆç®—å„é¡Œå¾—åˆ†
                this.questionBank.forEach((question, index) => {
                    const userAnswer = this.responses[index];
                    const isCorrect = userAnswer === question.correct;
                    
                    if (isCorrect) {
                        totalScore++;
                        abilityScores[question.ability].correct++;
                    }
                    abilityScores[question.ability].total++;
                });
                
                // è¨ˆç®—å„èƒ½åŠ›ç¶­åº¦ç™¾åˆ†æ¯”
                Object.keys(abilityScores).forEach(ability => {
                    const { correct, total } = abilityScores[ability];
                    this.abilities[ability] = total > 0 ? Math.round((correct / total) * 100) : 0;
                });
                
                // è¨ˆç®—ç¸½é«”å¾—åˆ†ç‡
                const overallScore = Math.round((totalScore / this.questionBank.length) * 100);
                
                // æ ¹æ“šå¾—åˆ†ç¢ºå®šCEFRç´šåˆ¥
                const cefrLevel = this.determineCEFRLevel(overallScore);
                
                // å„²å­˜çµæœåˆ°æ‡‰ç”¨ç¨‹å¼ç‹€æ…‹
                this.app.setUserLevel(cefrLevel, this.abilities);
            }
            
            determineCEFRLevel(overallScore) {
                if (overallScore >= 90) return 'C2';
                if (overallScore >= 80) return 'C1';
                if (overallScore >= 70) return 'B2';
                if (overallScore >= 60) return 'B1';
                if (overallScore >= 50) return 'A2';
                return 'A1';
            }
            
            showResults() {
                // éš±è—æ¸¬é©—ï¼Œé¡¯ç¤ºçµæœ
                document.querySelector('.assessment-test').style.display = 'none';
                document.querySelector('.assessment-result').style.display = 'block';
                
                // æ›´æ–°ç´šåˆ¥é¡¯ç¤º
                const levelBadge = document.getElementById('finalLevelBadge');
                const levelTitle = document.getElementById('levelTitle');
                const levelDescription = document.getElementById('levelDescription');
                
                const levelInfo = this.app.cefrLevels[this.app.userLevel];
                
                if (levelBadge) {
                    levelBadge.textContent = this.app.userLevel;
                    levelBadge.className = `final-level-badge level-badge ${this.app.userLevel.toLowerCase()}`;
                    levelBadge.style.width = '100px';
                    levelBadge.style.height = '100px';
                    levelBadge.style.borderRadius = '50%';
                    levelBadge.style.display = 'flex';
                    levelBadge.style.alignItems = 'center';
                    levelBadge.style.justifyContent = 'center';
                    levelBadge.style.fontSize = '2rem';
                    levelBadge.style.fontWeight = '700';
                    levelBadge.style.margin = '0 auto 1rem';
                }
                
                if (levelTitle) {
                    levelTitle.textContent = levelInfo.name;
                }
                
                if (levelDescription) {
                    levelDescription.textContent = `æ‚¨èƒ½${levelInfo.description}`;
                }
            }
            
            startLearningJourney() {
                this.app.switchModule('flashcard');
            }
            
            onShow() {
                if (this.app.userLevel) {
                    // å·²å®Œæˆæ¸¬é©—ï¼Œé¡¯ç¤ºçµæœ
                    document.querySelector('.assessment-intro').style.display = 'none';
                    document.querySelector('.level-overview').style.display = 'none';
                    document.querySelector('.assessment-test').style.display = 'none';
                    document.querySelector('.assessment-result').style.display = 'block';
                    this.showResults();
                } else {
                    // å°šæœªå®Œæˆæ¸¬é©—ï¼Œé¡¯ç¤ºä»‹ç´¹
                    document.querySelector('.assessment-intro').style.display = 'block';
                    document.querySelector('.level-overview').style.display = 'grid';
                    document.querySelector('.assessment-test').style.display = 'none';
                    document.querySelector('.assessment-result').style.display = 'none';
                }
            }
        }

        /**
         * æ™ºèƒ½å–®è©å¡ç‰‡æ¨¡çµ„
         */
        class FlashcardModule {
            constructor(app) {
                this.app = app;
                this.currentCard = 0;
                this.vocabulary = [];
                this.isFlipped = false;
                
                // åˆ†ç´šè©å½™åº«
                this.vocabularyDatabase = {
                    A1: [
                        { word: 'hello', phonetic: '/hÉ™ËˆlÉ™ÊŠ/', meaning: 'ä½ å¥½ï¼Œå“ˆå›‰', etymology: 'ä¾†è‡ªå¤è‹±èª hÇ£l', examples: [{ english: 'Hello, how are you?', chinese: 'ä½ å¥½ï¼Œä½ å¥½å—ï¼Ÿ' }] },
                        { word: 'cat', phonetic: '/kÃ¦t/', meaning: 'è²“', etymology: 'ä¾†è‡ªå¤è‹±èª catt', examples: [{ english: 'I have a cat.', chinese: 'æˆ‘æœ‰ä¸€éš»è²“ã€‚' }] }
                    ],
                    A2: [
                        { word: 'beautiful', phonetic: '/ËˆbjuËtÉªfÊŠl/', meaning: 'ç¾éº—çš„', etymology: 'ä¾†è‡ªå¤æ³•èª beaute', examples: [{ english: 'She is beautiful.', chinese: 'å¥¹å¾ˆç¾éº—ã€‚' }] },
                        { word: 'important', phonetic: '/ÉªmËˆpÉ”ËrtÉ™nt/', meaning: 'é‡è¦çš„', etymology: 'ä¾†è‡ªæ‹‰ä¸èª importare', examples: [{ english: 'This is important.', chinese: 'é€™å¾ˆé‡è¦ã€‚' }] }
                    ],
                    B1: [
                        { word: 'environment', phonetic: '/ÉªnËˆvaÉªrÉ™nmÉ™nt/', meaning: 'ç’°å¢ƒ', etymology: 'ä¾†è‡ªå¤æ³•èª environ', examples: [{ english: 'Protect the environment.', chinese: 'ä¿è­·ç’°å¢ƒã€‚' }] },
                        { word: 'opportunity', phonetic: '/ËŒÉ’pÉ™rËˆtuËnÉªti/', meaning: 'æ©Ÿæœƒ', etymology: 'ä¾†è‡ªæ‹‰ä¸èª opportunitas', examples: [{ english: 'Great opportunity!', chinese: 'å¥½æ©Ÿæœƒï¼' }] }
                    ],
                    B2: [
                        { word: 'sophisticated', phonetic: '/sÉ™ËˆfÉªstÉªkeÉªtÉªd/', meaning: 'è¤‡é›œçš„', etymology: 'ä¾†è‡ªå¸Œè‡˜èª sophistÄ“s', examples: [{ english: 'Sophisticated system.', chinese: 'è¤‡é›œçš„ç³»çµ±ã€‚' }] },
                        { word: 'nevertheless', phonetic: '/ËŒnevÉ™rÃ°É™Ëˆles/', meaning: 'ç„¶è€Œ', etymology: 'ä¾†è‡ª never + the + less', examples: [{ english: 'Nevertheless, we succeeded.', chinese: 'ç„¶è€Œï¼Œæˆ‘å€‘æˆåŠŸäº†ã€‚' }] }
                    ],
                    C1: [
                        { word: 'ubiquitous', phonetic: '/juËËˆbÉªkwÉªtÉ™s/', meaning: 'ç„¡æ‰€ä¸åœ¨çš„', etymology: 'ä¾†è‡ªæ‹‰ä¸èª ubique', examples: [{ english: 'Smartphones are ubiquitous.', chinese: 'æ™ºæ…§æ‰‹æ©Ÿç„¡æ‰€ä¸åœ¨ã€‚' }] },
                        { word: 'paradigm', phonetic: '/ËˆpÃ¦rÉ™daÉªm/', meaning: 'å…¸ç¯„', etymology: 'ä¾†è‡ªå¸Œè‡˜èª paradeigma', examples: [{ english: 'New paradigm in education.', chinese: 'æ•™è‚²æ–°å…¸ç¯„ã€‚' }] }
                    ],
                    C2: [
                        { word: 'perspicacious', phonetic: '/ËŒpÉœËspÉªËˆkeÉªÊƒÉ™s/', meaning: 'æ´å¯ŸåŠ›æ•éŠ³çš„', etymology: 'ä¾†è‡ªæ‹‰ä¸èª perspicax', examples: [{ english: 'Perspicacious analysis.', chinese: 'æ•éŠ³çš„åˆ†æã€‚' }] }
                    ]
                };
                
                this.init();
            }
            
            init() {
                console.log('ğŸ“š å–®è©å¡ç‰‡æ¨¡çµ„åˆå§‹åŒ–');
                this.setupEventListeners();
                this.loadLeveledVocabulary();
            }
            
            setupEventListeners() {
                const flipBtn = document.getElementById('flipCard');
                const prevBtn = document.getElementById('prevCard');
                const nextBtn = document.getElementById('nextCard');
                
                if (flipBtn) flipBtn.addEventListener('click', () => this.flipCard());
                if (prevBtn) prevBtn.addEventListener('click', () => this.previousCard());
                if (nextBtn) nextBtn.addEventListener('click', () => this.nextCard());
                
                // ç›£è½ç´šåˆ¥è®Šæ›´
                this.app.on('levelChanged', (data) => {
                    this.loadLeveledVocabulary(data.level);
                });
            }
            
            loadLeveledVocabulary(level = null) {
                const userLevel = level || this.app.userLevel || 'A1';
                console.log(`ğŸ“– è¼‰å…¥ ${userLevel} ç´šåˆ¥è©å½™`);
                
                // è¼‰å…¥ç•¶å‰ç´šåˆ¥åŠä»¥ä¸‹çš„è©å½™
                this.vocabulary = [];
                const levels = ['A1', 'A2', 'B1', 'B2', 'C1', 'C2'];
                const currentLevelIndex = levels.indexOf(userLevel);
                
                for (let i = 0; i <= currentLevelIndex; i++) {
                    const levelVocab = this.vocabularyDatabase[levels[i]] || [];
                    this.vocabulary.push(...levelVocab);
                }
                
                // æ‰“äº‚é †åº
                this.vocabulary = this.shuffleArray(this.vocabulary);
                
                // é‡ç½®å¡ç‰‡ç‹€æ…‹
                this.currentCard = 0;
                this.isFlipped = false;
                
                // æ›´æ–°é¡¯ç¤º
                this.updateLevelDisplay(userLevel);
                this.showCurrentCard();
                this.updateProgress();
            }
            
            updateLevelDisplay(level) {
                const levelElement = document.getElementById('flashcardLevel');
                if (levelElement) {
                    levelElement.textContent = level;
                    levelElement.className = `current-level level-badge ${level.toLowerCase()}`;
                }
            }
            
            showCurrentCard() {
                if (this.vocabulary.length === 0) {
                    this.showNoVocabularyMessage();
                    return;
                }
                
                const word = this.vocabulary[this.currentCard];
                if (!word) return;
                
                // æ›´æ–°æ­£é¢å…§å®¹
                this.updateCardFront(word);
                
                // æ›´æ–°èƒŒé¢å…§å®¹
                this.updateCardBack(word);
                
                // é‡ç½®ç¿»è½‰ç‹€æ…‹
                this.resetFlipState();
                
                // æ›´æ–°é€²åº¦
                this.updateProgress();
            }
            
            updateCardFront(word) {
                const elements = {
                    badge: document.getElementById('wordLevelBadge'),
                    main: document.getElementById('wordMain'),
                    phonetic: document.getElementById('wordPhonetic')
                };
                
                if (elements.badge) {
                    const level = this.getWordLevel(word);
                    elements.badge.textContent = level;
                    elements.badge.className = `word-level-badge level-badge ${level.toLowerCase()}`;
                }
                
                if (elements.main) {
                    elements.main.textContent = word.word;
                }
                
                if (elements.phonetic) {
                    elements.phonetic.textContent = word.phonetic;
                }
            }
            
            updateCardBack(word) {
                const elements = {
                    meaning: document.getElementById('wordMeaning'),
                    etymology: document.getElementById('wordEtymology'),
                    exampleEn: document.getElementById('exampleEnglish'),
                    exampleZh: document.getElementById('exampleChinese')
                };
                
                if (elements.meaning) {
                    elements.meaning.textContent = word.meaning;
                }
                
                if (elements.etymology) {
                    elements.etymology.textContent = word.etymology;
                }
                
                const randomExample = word.examples[0]; // ä½¿ç”¨ç¬¬ä¸€å€‹ä¾‹å¥
                
                if (elements.exampleEn) {
                    elements.exampleEn.textContent = randomExample.english;
                }
                
                if (elements.exampleZh) {
                    elements.exampleZh.textContent = randomExample.chinese;
                }
            }
            
            getWordLevel(word) {
                // æ ¹æ“šè©å½™åº«æ‰¾å‡ºå–®è©ç´šåˆ¥
                for (const [level, words] of Object.entries(this.vocabularyDatabase)) {
                    if (words.some(w => w.word === word.word)) {
                        return level;
                    }
                }
                return 'A1';
            }
            
            flipCard() {
                const cardElement = document.getElementById('flashcard3D');
                if (!cardElement) return;
                
                this.isFlipped = !this.isFlipped;
                cardElement.classList.toggle('flipped', this.isFlipped);
                
                const flipBtn = document.getElementById('flipCard');
                if (flipBtn) {
                    flipBtn.textContent = this.isFlipped ? 'ç¿»å›' : 'ç¿»è½‰';
                }
            }
            
            resetFlipState() {
                const cardElement = document.getElementById('flashcard3D');
                if (!cardElement) return;
                
                this.isFlipped = false;
                cardElement.classList.remove('flipped');
                
                const flipBtn = document.getElementById('flipCard');
                if (flipBtn) {
                    flipBtn.textContent = 'ç¿»è½‰';
                }
            }
            
            previousCard() {
                if (this.vocabulary.length === 0) return;
                
                this.currentCard = (this.currentCard - 1 + this.vocabulary.length) % this.vocabulary.length;
                this.showCurrentCard();
            }
            
            nextCard() {
                if (this.vocabulary.length === 0) return;
                
                this.currentCard = (this.currentCard + 1) % this.vocabulary.length;
                this.showCurrentCard();
            }
            
            updateProgress() {
                const progressElement = document.getElementById('cardProgress');
                const progressFillElement = document.getElementById('cardProgressFill');
                
                if (progressElement) {
                    progressElement.textContent = `${this.currentCard + 1} / ${this.vocabulary.length}`;
                }
                
                if (progressFillElement && this.vocabulary.length > 0) {
                    const progress = ((this.currentCard + 1) / this.vocabulary.length) * 100;
                    progressFillElement.style.width = `${progress}%`;
                }
            }
            
            showNoVocabularyMessage() {
                const cardElement = document.getElementById('flashcard3D');
                if (cardElement) {
                    cardElement.innerHTML = `
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; padding: 2rem; text-align: center; background: var(--bg-primary); border-radius: 1rem;">
                            <h3>æš«ç„¡è©å½™</h3>
                            <p>è«‹å…ˆå®Œæˆåˆ†ç´šæ¸¬é©—ä»¥è¼‰å…¥é©åˆçš„è©å½™</p>
                            <button class="btn btn-primary" onclick="app.switchModule('assessment')">
                                å‰å¾€åˆ†ç´šæ¸¬é©—
                            </button>
                        </div>
                    `;
                }
            }
            
            onShow() {
                if (this.vocabulary.length === 0) {
                    this.loadLeveledVocabulary();
                }
            }
            
            shuffleArray(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }
        }

        /**
         * å¤šæ¨¡å¼é–±è®€æ¨¡çµ„
         */
        class ReadingModule {
            constructor(app) {
                this.app = app;
                this.init();
            }
            
            init() {
                console.log('ğŸ“– é–±è®€æ¨¡çµ„åˆå§‹åŒ–');
            }
            
            onShow() {
                console.log('ğŸ“– é–±è®€æ¨¡çµ„å·²é¡¯ç¤º');
            }
        }

        /**
         * ç†è§£æ¸¬è©¦è©•ä¼°æ¨¡çµ„
         */
        class QuizModule {
            constructor(app) {
                this.app = app;
                this.init();
            }
            
            init() {
                console.log('ğŸ§  æ¸¬è©¦æ¨¡çµ„åˆå§‹åŒ–');
            }
            
            onShow() {
                console.log('ğŸ§  æ¸¬è©¦æ¨¡çµ„å·²é¡¯ç¤º');
            }
        }

        /**
         * å€‹æ€§åŒ–æˆå°±æµ·å ±æ¨¡çµ„
         */
        class PosterModule {
            constructor(app) {
                this.app = app;
                this.init();
            }
            
            init() {
                console.log('ğŸ† æµ·å ±æ¨¡çµ„åˆå§‹åŒ–');
            }
            
            onShow() {
                console.log('ğŸ† æµ·å ±æ¨¡çµ„å·²é¡¯ç¤º');
            }
        }

        // å…¨åŸŸè®Šæ•¸
        let app;

        // æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•
        document.addEventListener('DOMContentLoaded', function() {
            app = new CEFRLearningApp();
            app.init();
        });
    </script>
</body>
</html>